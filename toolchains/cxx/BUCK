load("@rust//constraints:defs.bzl", "configuration_transition")

# Transition to share identical C++ compilations between stage1 and stage2.
configuration_transition(
    name = "prune_cxx_configuration",
    discard_settings = [
        "rust//constraints:bootstrap-stage",
        "rust//constraints:build-script",
        "rust//constraints:sysroot-deps",
        "rust//constraints:workspace",
    ],
    label = "cxx",
)

prebuilt_cxx_library(
    name = "stdlib",
    default_target_platform = "rust//platforms:host",
    exported_linker_flags = select({
        "DEFAULT": None,
        "prelude//os:linux": ["-lstdc++"],
        "prelude//os:macos": ["-lc++"],
    }),
    visibility = ["PUBLIC"],
)
